repos:
  # 1. VỆ SINH CƠ BẢN (Code Hygiene)
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace   # Xóa khoảng trắng thừa cuối dòng
      - id: end-of-file-fixer     # Đảm bảo file kết thúc bằng dòng trống
      - id: check-yaml            # Kiểm tra cú pháp file docker-compose.yml
      - id: check-added-large-files # Chặn lỡ tay commit file nặng > 500kb

  # 2. BANDIT (Quét bảo mật Python - App & Auth Server)
  - repo: https://github.com/PyCQA/bandit
    rev: 1.7.5
    hooks:
      - id: bandit
        name: bandit-security-check
        description: "Quét lỗ hổng bảo mật trong code Python (eval, exec...)"
        entry: bandit
        language: python
        types: [python]
        # -r: Đệ quy (quét hết thư mục con)
        # -ll: Chỉ báo lỗi mức độ Medium/High (bỏ qua Low đỡ spam)
        args: ["-ll", "-r", "services/"] 

  # 3. HADOLINT (Quét Dockerfile - Kiểm tra Golden Image & Services)
  # Lưu ý: Hook này sử dụng Docker để chạy Hadolint (không cần cài binary)
  - repo: https://github.com/hadolint/hadolint
    rev: v2.12.0
    hooks:
      - id: hadolint-docker
        name: hadolint-dockerfile-check
        entry: hadolint
        # Chỉ quét các file có tên là "Dockerfile"
        files: Dockerfile